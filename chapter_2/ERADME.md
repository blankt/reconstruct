### 重构的定义
**重构（名次）**：对软件内部结构的一种调整，在不改变软件的可观测行为（用户关心的行为）的前提下提高其可理解性，降低修改成本。

**重构（动词）**：使用一系列重构手法，在不改变软件可观测行为下的前提下，调整其结构。

重构的关键在于运用大量微小且保持软件行为的步骤，一步步达到大规模的修改。

Tip：如果有人说他们的代码在重构过程中有一两天时间不可用，基本上可以确定，他们在做的事不是重构。

### 何时重构
1. 预备性重构：让添加新功能更加容易
在添加新功能之前，看现有代码库的代码，看是否做一些修改能使新功能的添加更加方便、快捷。
2. 帮助理解的重构：使代码更易懂
在着手修改代码之前，应该先理解代码的逻辑。如果代码逻辑混乱则需要先进行修改，让自己理解代码讲了什么；
修改代码会让自己对代码的理解融入代码中，无论是修改变量名，还是抽取函数等简单的修改，都会降低人理解代码的成本。
有了对代码细微的整理才能进一步看到更大的问题以及是否有更好的优化方法。
3. 捡垃圾式的重构
在进行任务时发现重构与当前任务无关的代码很容易做时就立马重构，如果发现需要费时则记录下来等当前任务完成时候再做。
4. 长期重构
当有人靠近重构区域时，每次做一些细微的修改，把代码朝向希望的方向推进。
好处时，改动后系统能正常的工作。
5. 复审代码时重构
在code review流程中提出建议并进行代码修改。

## 何时不应该重构
1. 不需要修改该部分代码，且代码能正常运行。
2. 重写比重构简单时。

## 重构与架构
在开始写代码之前，就对软件进行完美的架构设计是困难的。有了重构技术可以在逐步的修改中对软件架构进行大幅度修改。
重构对架构最大的影响在于通过重构可以获取一个良好的代码库以应对不断变化的需求。
在写代码之前就做好架构设计这个假设的前提是对需求有清晰的了解，但这个是不切合实际的。
应对变化的最好方法就是添加灵活性机制，为了应对预期中的场景，在代码编写中预先留一些余地，但有一些需要注意：
- 如果所留的余地使代码过于复杂则不值得
有了重构技术，我就可以采取不同的策略。与其猜测未来需要哪些灵活性、需要什么机制来提供灵活性，我更愿意只根据当前的需求来构造软件，
同时把软件的设计质量做得很高。随着对用户需求的理解加深，我会对架构进行重构，使其能够应对新的需要。
演进式架构与重构很配。

## 重构与性能
重构虽然可能会是软件运行过程变慢，但是也能使性能优化变得更加容易。除开一个对性能要求很高的实时系统，一般做法是先开发出可优化的系统，再针对具体的性能
要求进行优化。
在大多数程序中，大半的时间消耗都在少部分代码上，在进行优化之前不要臆测哪些代码是性能瓶颈，应该先进行性能分析，找出性能瓶颈，再进行优化。
重构的确可能使软件变慢，但它使优化阶段的软件性能调优更容易，最终还是会得到好的效果。